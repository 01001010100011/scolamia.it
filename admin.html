<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin - ScolaMia.it</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { accent: "#0c7ff2", paper: "#f4f3ee", ink: "#101010" },
          fontFamily: { display: ["Bebas Neue", "sans-serif"], body: ["IBM Plex Sans", "sans-serif"] },
          boxShadow: { brutal: "4px 4px 0 0 #000" }
        }
      }
    };
  </script>
  <style>
    body { font-family: "IBM Plex Sans", sans-serif; background: #f4f3ee; }
    .headline { font-family: "Bebas Neue", sans-serif; letter-spacing: 0.04em; }
  </style>
</head>
<body class="text-ink">
  <header class="border-b-4 border-black bg-white">
    <div class="max-w-6xl mx-auto px-4 md:px-8 py-4 flex items-center justify-between">
      <h1 class="headline text-5xl">Pannello Admin</h1>
      <a href="index.html" class="text-sm font-bold uppercase underline">Torna alla Home</a>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 md:px-8 py-8 space-y-8">
    <section id="loginBox" class="border-4 border-black bg-white p-6 shadow-brutal max-w-xl">
      <h2 class="headline text-4xl">Login</h2>
      <p class="text-sm mt-1">Accedi con email e password admin Supabase per gestire articoli, countdown e agenda.</p>
      <form id="loginForm" class="mt-4 space-y-3">
        <input id="email" type="email" required placeholder="Email admin" class="w-full border-2 border-black" />
        <input id="password" type="password" required placeholder="Password admin" class="w-full border-2 border-black" />
        <button type="submit" class="border-2 border-black bg-black text-white px-4 py-2 text-xs font-bold uppercase shadow-brutal">Accedi</button>
      </form>
      <p id="loginError" class="text-red-700 text-sm mt-3 hidden">Password non valida.</p>
    </section>

    <section id="adminPanel" class="hidden space-y-8">
      <p id="adminStatus" class="hidden border-2 border-black bg-yellow-100 px-3 py-2 text-xs font-semibold"></p>
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <h2 class="headline text-4xl">Dashboard Admin</h2>
        <div class="flex gap-2">
          <button type="button" id="newItemBtn" class="border-2 border-black bg-accent text-white px-4 py-2 text-xs font-bold uppercase">Nuovo articolo</button>
          <button type="button" id="logoutBtn" class="border-2 border-black bg-white px-4 py-2 text-xs font-bold uppercase">Logout</button>
        </div>
      </div>

      <div class="flex gap-2">
        <button type="button" id="openContentArticlesBtn" class="border-2 border-black px-4 py-2 text-xs font-bold uppercase bg-black text-white">Gestione articoli</button>
        <button type="button" id="openContentCountdownBtn" class="border-2 border-black px-4 py-2 text-xs font-bold uppercase bg-white">Gestione countdown</button>
        <button type="button" id="openContentAgendaBtn" class="border-2 border-black px-4 py-2 text-xs font-bold uppercase bg-white">Gestione agenda</button>
      </div>

      <section id="articlesSection" class="space-y-8">
        <div class="flex gap-2">
          <button type="button" id="openArticlesViewBtn" class="border-2 border-black px-4 py-2 text-xs font-bold uppercase bg-black text-white">Modifica articoli</button>
          <button type="button" id="openFeaturedViewBtn" class="border-2 border-black px-4 py-2 text-xs font-bold uppercase bg-white">Articoli in evidenza</button>
        </div>

        <section id="articlesView" class="space-y-8">
          <form id="articleForm" class="border-4 border-black bg-white p-6 shadow-brutal space-y-4">
            <input type="hidden" id="articleId" />
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="text-xs font-bold uppercase">Titolo</label>
                <input id="title" required class="w-full border-2 border-black" />
              </div>
              <div>
                <label class="text-xs font-bold uppercase">Categoria</label>
                <input id="category" required class="w-full border-2 border-black" placeholder="Compiti, Eventi, Progetti..." />
              </div>
            </div>
            <div>
              <label class="text-xs font-bold uppercase">Estratto</label>
              <textarea id="excerpt" required rows="2" class="w-full border-2 border-black"></textarea>
            </div>
            <div>
              <label class="text-xs font-bold uppercase">Contenuto</label>
              <textarea id="content" required rows="8" class="w-full border-2 border-black"></textarea>
            </div>
            <div class="space-y-2">
              <label class="text-xs font-bold uppercase">Foto articolo</label>
              <input id="articleImageInput" type="file" accept="image/*" class="w-full border-2 border-black file:mr-3 file:border-0 file:bg-black file:px-3 file:py-2 file:text-xs file:font-bold file:uppercase file:text-white" />
              <p class="text-[11px] text-slate-600">L'immagine viene adattata automaticamente in tutte le card e nel dettaglio articolo.</p>
              <img id="articleImagePreview" alt="Anteprima foto articolo" class="hidden w-full max-h-56 object-cover border-2 border-black" />
              <button type="button" id="removeArticleImageBtn" class="hidden border-2 border-black bg-white px-3 py-1 text-[11px] font-bold uppercase">Rimuovi foto</button>
            </div>
            <div class="space-y-2">
              <label class="text-xs font-bold uppercase">Allegati scaricabili</label>
              <input id="articleAttachmentInput" type="file" multiple class="w-full border-2 border-black file:mr-3 file:border-0 file:bg-black file:px-3 file:py-2 file:text-xs file:font-bold file:uppercase file:text-white" />
              <p class="text-[11px] text-slate-600">Puoi allegare PDF, MP4 e altri file. Gli utenti potranno scaricarli a fine articolo.</p>
              <div id="articleAttachmentList" class="space-y-2"></div>
            </div>
            <label class="inline-flex items-center gap-2 font-semibold"><input id="published" type="checkbox" checked /> Pubblica subito</label>
            <div class="flex gap-3">
              <button type="submit" id="submitArticleBtn" class="border-2 border-black bg-accent text-white px-4 py-2 text-xs font-bold uppercase shadow-brutal">Salva Articolo</button>
            </div>
          </form>

          <section class="border-4 border-black bg-white p-6 shadow-brutal">
            <h3 class="headline text-3xl">Articoli salvati</h3>
            <div id="adminArticles" class="mt-4 space-y-3"></div>
          </section>
        </section>

        <section id="featuredView" class="hidden space-y-4 border-4 border-black bg-white p-6 shadow-brutal">
          <h3 class="headline text-3xl">Scelta articoli in evidenza</h3>
          <p class="text-sm">Seleziona gli articoli pubblicati da mostrare in home e riordina la lista in evidenza con drag &amp; drop.</p>
          <div id="featuredManagerList" class="space-y-3"></div>
        </section>
      </section>

      <section id="countdownSection" class="hidden space-y-8">
        <form id="countdownForm" class="border-4 border-black bg-white p-6 shadow-brutal space-y-4">
          <input type="hidden" id="countdownId" />
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label class="text-xs font-bold uppercase">Titolo countdown</label>
              <input id="countdownTitle" required class="w-full border-2 border-black" placeholder="Fine della scuola" />
            </div>
            <div>
              <label class="text-xs font-bold uppercase">Data e ora target</label>
              <input id="countdownTargetAt" type="datetime-local" required class="w-full border-2 border-black" />
            </div>
          </div>
          <div class="flex flex-wrap gap-4 items-center">
            <label class="inline-flex items-center gap-2 font-semibold"><input id="countdownIsFeatured" type="checkbox" /> Countdown principale</label>
            <label class="inline-flex items-center gap-2 font-semibold"><input id="countdownActive" type="checkbox" checked /> Attivo</label>
          </div>
          <div class="flex gap-3">
            <button type="submit" id="submitCountdownBtn" class="border-2 border-black bg-accent text-white px-4 py-2 text-xs font-bold uppercase shadow-brutal">Salva Countdown</button>
          </div>
        </form>

        <section class="border-4 border-black bg-white p-6 shadow-brutal">
          <div class="flex items-center justify-between gap-3">
            <h3 class="headline text-3xl">Countdown salvati</h3>
            <button type="button" id="newCountdownBtn" class="border-2 border-black px-3 py-1 text-xs font-bold uppercase">Nuovo countdown</button>
          </div>
          <div id="adminCountdowns" class="mt-4 space-y-3"></div>
        </section>
      </section>

      <section id="agendaSection" class="hidden space-y-8">
        <form id="agendaForm" class="border-4 border-black bg-white p-6 shadow-brutal space-y-4">
          <input type="hidden" id="agendaEventId" />
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label class="text-xs font-bold uppercase">Titolo evento</label>
              <input id="agendaTitle" required class="w-full border-2 border-black" />
            </div>
            <div>
              <label class="text-xs font-bold uppercase">Categoria</label>
              <input id="agendaCategory" required class="w-full border-2 border-black" placeholder="Didattica, Istituto, Laboratori..." />
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label class="text-xs font-bold uppercase">Data</label>
              <input id="agendaDate" type="date" required class="w-full border-2 border-black" />
            </div>
            <div>
              <label class="text-xs font-bold uppercase">Descrizione</label>
              <input id="agendaDescription" required class="w-full border-2 border-black" />
            </div>
          </div>
          <div class="flex gap-3">
            <button type="submit" id="submitAgendaBtn" class="border-2 border-black bg-accent text-white px-4 py-2 text-xs font-bold uppercase shadow-brutal">Salva Evento</button>
          </div>
        </form>

        <section class="border-4 border-black bg-white p-6 shadow-brutal">
          <h3 class="headline text-3xl">Eventi agenda</h3>
          <div id="adminAgendaEvents" class="mt-4 space-y-3"></div>
        </section>
      </section>
    </section>
  </main>

  <script type="module" src="assets/js/admin.js?v=20260222b"></script>
</body>
</html>
